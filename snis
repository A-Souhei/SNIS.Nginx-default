server {

  gzip on; # Enables compression, incl Web API content-types
  gzip_types
    "application/json;charset=utf-8" application/json
    "application/javascript;charset=utf-8" application/javascript text/javascript
    "application/xml;charset=utf-8" application/xml text/xml
    "text/css;charset=utf-8" text/css
    "text/plain;charset=utf-8" text/plain;

    location ~ (\.js|\.css|\.gif|\.ico|(/dhis-web-commons/|/images/|/icons/).*\.png)$ {
      add_header  Cache-Control public;
      expires     14d;

    }

    location ~ (\.woff|\.ttf|\.eot)$ {
      add_header  Cache-Control no-cache;

    }



	root /ROOT;

	# Add index.php to the list if you are using PHP
	index index.html index.htm index.nginx-debian.html;
    server_name sante.seie-madagascar.org; # managed by Certbot


	location / {

           proxy_pass http://127.0.0.1:8080;
           proxy_redirect            off;
           proxy_set_header          Host $host:$server_port;
           proxy_set_header          X-Real-IP          $remote_addr;
           proxy_set_header          X-Forwarded-For    $proxy_add_x_forwarded_for;
           proxy_set_header          X-Forwarded-Proto  https;
           proxy_buffer_size         128k;
           proxy_buffers             8 128k;
           proxy_busy_buffers_size   256k;
	}



    listen [::]:443 ssl ipv6only=on; # managed by Certbot
    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/sante.seie-madagascar.org/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/sante.seie-madagascar.org/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

}
server {
        return 301 https://$host$request_uri;


	listen 80 ;
	listen [::]:80 ;
    root /ROOT;
    server_name myservername;
    return 404; # managed by Certbot

    location ~ (\.js|\.css|\.gif|\.ico|(/dhis-web-commons/|/images/|/icons/).*\.png)$ {
      add_header  Cache-Control public;
      expires     14d;

    }

    location ~ (\.woff|\.ttf|\.eot)$ {
      add_header  Cache-Control no-cache;

    }


}
